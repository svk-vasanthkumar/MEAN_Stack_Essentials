<!DOCTYPE html>
<html>
<head>
  <title>Kaipulla Bus Booking â€“ All Tickets</title>
  <link rel="stylesheet" href="details.css">
</head>
<body>

<h1>ğŸšŒ Kaipulla Bus Booking</h1>
<h3>Booked Tickets</h3>

<div class="ticket-container" id="list"></div>

<a href="index.html" class="back">â¬… Back to Booking</a>

<script>
  async function loadTickets() {
    const res = await fetch("/tickets");
    const tickets = await res.json();

    let output = "";

    tickets.forEach((t, i) => {
      output += `
        <div class="ticket">
          <h4>ğŸ« Ticket ${i + 1}</h4>
          <p><b>Route:</b> ${t.from} â ${t.to}</p>
          <p><b>Date:</b> ${t.date}</p>
          <hr>
          <p><b>Name:</b> ${t.name}</p>
          <p><b>Seat:</b> ${t.seat}</p>

          <button class="cancel" onclick="cancelTicket('${t._id}')"> 
            âŒ Cancel Ticket
          </button>
        </div>
      `;
    });

    document.getElementById("list").innerHTML = output;
  }

  async function cancelTicket(id) {
    if (!confirm("Are you sure to cancel this ticket?")) return;

    const res = await fetch("/tickets/" + id, {
      method: "DELETE"
    });

    const result = await res.json();
    alert(result.message);

    loadTickets(); // refresh list
  }

  loadTickets();
</script>

</body>
</html>
